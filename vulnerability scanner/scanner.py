import argparse
from modules.port_scanner import scan_ports
from modules.banner_grabber import grab_banner
from modules.vulnerability_checker import check_vulnerability

def main():
    parser = argparse.ArgumentParser(description="Simple Vulnerability Scanner")
    parser.add_argument('--target', required=True, help='Target IP address')
    parser.add_argument('--ports', required=True, help='Port range, e.g., 1-1000')

    args = parser.parse_args()
    target = args.target
    port_range = args.ports.split('-')

    open_ports = scan_ports(target, int(port_range[0]), int(port_range[1]))

    for port in open_ports:
        banner = grab_banner(target, port)
        if banner:
            check_vulnerability(banner)

if __name__ == "__main__":
    main()
